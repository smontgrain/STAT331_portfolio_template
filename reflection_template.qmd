---
title: "STAT 331 Portfolio"
author: "Sebastien Montgrain"
format: html 
embed-resources: true
layout: margin-left
editor: visual
execute: 
  eval: false
  echo: true
---

[**My Grade:**]{.underline} I believe my grade equivalent to course work evidenced below to be an A.

[**Learning Objective Evidence:**]{.underline} In the code chunks below, provide code from Lab or Challenge assignments where you believe you have demonstrated proficiency with the specified learning target. Be sure to specify **where** the code came from (e.g., Lab 4 Question 2).

## Working with Data

**WD-1: I can import data from a *variety* of formats (e.g., csv, xlsx, txt, etc.).**

-   `csv` Example 1

```{r}
#| label: wd-1-csv-1
# Lab 2 Question 1

surveys <- read_csv(here::here("Week 2", "Lab 2", "surveys.csv"))

```

-   `csv` Example 2

```{r}
#| label: wd-1-csv-2
#Lab 3 Question 2

surveys <- read_csv(here::here("Week 3", "Lab 3", "teacher_evals.csv"))

```

-   `xlsx`

```{r}
#| label: wd-1-xlsx
#PA 4 Question 1

military <- read_xlsx("gov_spending_per_capita.xlsx",
                      sheet = "Share of Govt. spending",
                      skip  = 7,
                      n_max = 190,
                      na = c(". .", "xxx", "..")
                      )
```

**WD-2: I can select necessary columns from a dataset.**

-   Example selecting specified columns

```{r}
#| label: wd-2-ex-1
ca_childcare |>
  filter(study_year %in% c(2008, 2018)) |>
  group_by(census_region, study_year) |>
  summarize(median_income = median(mhi_2018, na.rm = TRUE)) |>
  select(census_region, study_year, median_income) |>
  pivot_wider(names_from = study_year, values_from = median_income, names_prefix = "median_income_") |>
  arrange(desc(median_income_2018)) |>
  ungroup()
```

-   Example removing specified columns

```{r}
#| label: wd-2-ex-2
# Lab 5 Chunk 3

crime_info <- crime_scene_report |>
  filter(date == 20180115, city == "SQL City", type == "murder") |>
  select(-date, -type, -city) |>
  pull(description)
crime_info
```

-   Example selecting columns based on logical values (e.g., `starts_with()`, `ends_with()`, `contains()`, `where()`)

```{r}
#| label: wd-2-ex-3
# Lab 4 Question 7
# Your Comments: Nice work pivoting and modifying the age variable!Nice work reordering your legend and your facets!!! I strongly recommend against nested functions, as they are difficult for people to understand what your code is doing. Having two lines is not less efficient and is more readable. Can you relevel the ages BEFORE your facet them? Can you match my colors??? These are coming from a package and you will need to expand the color palette to get all 10 colors.

#REVISION: I removed the nested function of facet_grid(~factor(age_group)) and turned it into simply facet_grid(~age_group), and I defined age group earlier in the pipeline using a fct_relevel, which I used this source to remind myself. https://forcats.tidyverse.org/reference/fct_relevel.html#ref-examples. I learned in challenge 4 how to show every year on the x axis, but I didn't know how to skip years like your graph so I just tilted the labels so you can read them all. Using information from the discord I learned how to import a color palette and expand it, and then assign the colors to my plot with scale_color_manual(). Then I made the legend smaller and I used doge to alternate the year axis labels, I think skipping every other one would look better in this scenario but I thought it was a cool skill I learned so I wanted to show it.

my_colors = colorRampPalette(brewer.pal(7, "Accent"))(10)
graph_maker <- ca_childcare |>
  select(census_region, study_year, starts_with("mc_")) |>
  pivot_longer(cols = c(mc_infant, mc_toddler, mc_preschool),
               names_to = "age_group",
               values_to = "monthly_cost") |>
  mutate(age_group = fct_recode(age_group,
                                "Infant" = "mc_infant",
                                "Toddler" = "mc_toddler",
                                "Preschool" = "mc_preschool"), 
         age_group = fct_relevel(age_group, "Infant", "Toddler", "Preschool")
         )
ggplot(data = graph_maker, 
       mapping = aes(x = study_year, y = monthly_cost,
                     color = fct_reorder2(.f = census_region, .x = study_year, .y = monthly_cost))) +
  geom_point() +
  geom_smooth() +
  theme_bw() +
  theme(aspect.ratio = 1, axis.text.x = element_text(size = 5),
        legend.text = element_text(size = 7),
        legend.title = element_text(size = 10),
        legend.key.size = unit(10, "pt")) +
  scale_color_manual(values = my_colors) +
  labs(
    title = "Weekly Median Price for Center-Based Childcare ($)",
    x = "Study Year", y = "", color = "California Region") +
  facet_grid(~ age_group) +
  scale_x_continuous(breaks = unique(graph_maker$study_year),
                     guide = guide_axis(n.dodge = 2))
```

**WD-3: I can filter rows from a dataframe for a *variety* of data types (e.g., numeric, integer, character, factor, date).**

-   Numeric Example 1

```{r}
#| label: wd-3-numeric-ex-1
# Lab 3 Question 5

teacher_evals_clean <- surveys |>
  rename(sex = gender) |>
  filter(no_participants >= 10) |>
  mutate(course_id = as.character(course_id),
         teacher_id = as.character(teacher_id),
         sex = as.factor(sex)) |>
  select(course_id,
         teacher_id,
         question_no,
         no_participants,
         resp_share,
         SET_score_avg,
         percent_failed_cur,
         academic_degree,
         seniority,
         sex)
```

-   Numeric Example 2

```{r}
#| label: wd-3-numeric-ex-2
#Challenge 3 Chunk 3

teacher_evals_compare <- surveys |>
  filter(question_no == 903) |>
  mutate(SET_level = case_when(
          SET_score_avg >= 4 ~ "excellent",
          SET_score_avg < 4 ~ "standard"),
         sen_level = case_when(
           seniority <= 4 ~ "junior",
           seniority <= 8 ~ "senior",
           seniority > 8 ~ "very senior"
         )) |>
  select(course_id, SET_level, sen_level)
```

-   Character Example 1 (any context)

```{r}
#| label: wd-3-character
# Challenge 4 Chunk 3

clean_data <- counties |>
  left_join(childcare_costs, join_by(county_fips_code)) |>
  filter(state_name == "California") |>
  group_by(study_year) |>
  summarise(across(
      .cols = c(mcsa, mfccsa, mhi_2018), 
      ~median(.x, na.rm = TRUE))) |>
  select(study_year, mcsa, mfccsa, mhi_2018)
```

-   Character Example 2 (example must use functions from **stringr**)

```{r}
#| label: wd-3-string
# Lab 5 Chunk 5

gym_member <- get_fit_now_member |>
  left_join(y = get_fit_now_check_in, join_by(id == membership_id)) |>
  filter(str_detect(membership_status, 
           pattern = "gold"), 
         str_detect(id, 
           pattern = "^48Z"))
#two options, Joe Germuska or Jeremy Bowers, need to check license plate now.
plate_check <- almost_everything_data |>
  filter(str_detect(name.x, 
           pattern = "Jeremy Bowers")) |>
  pull(transcript)
plate_check
```

-   Date (example must use functions from **lubridate**)

```{r}
#| label: wd-3-date
# Lab 5 Chunk 3

crime_info <- crime_scene_report |>
  mutate(date = ymd(date)) |>
  filter(year(date) == 2018, month(date) == 01, day(date) == 15, city == "SQL City", type == "murder") |>
  select(-date, -type, -city) |>
  pull(description)
crime_info
```

**WD-4: I can modify existing variables and create new variables in a dataframe for a *variety* of data types (e.g., numeric, integer, character, factor, date).**

-   Numeric Example 1

```{r}
#| label: wd-4-numeric-ex-1
# Challenge 3 Question 1

teacher_evals_compare <- surveys |>
  filter(question_no == 903) |>
  mutate(SET_level = case_when(
          SET_score_avg >= 4 ~ "excellent",
          SET_score_avg < 4 ~ "standard"),
         sen_level = case_when(
           seniority <= 4 ~ "junior",
           seniority <= 8 ~ "senior",
           seniority > 8 ~ "very senior"
         )) |>
  select(course_id, SET_level, sen_level)
```

-   Numeric Example 2

```{r}
#| label: wd-4-numeric-ex-2
#Lab 5 Chunk 3

crime_info <- crime_scene_report |>
  mutate(date = ymd(date), MONTH = case_when(
          month(date) == 1 ~ "January")) |>
  filter(year(date) == 2018, MONTH == "January", day(date) == 15, city == "SQL City", type == "murder") |>
  select(-date, -type, -city) |>
  pull(description)
crime_info
```

-   Factor Example 1 (renaming levels)

```{r}
#| label: wd-4-factor-ex-1
# Lab 4 Question 4

ca_childcare <- ca_childcare |> 
  mutate(county_name = str_remove(county_name, " County"),
         census_region = fct_collapse(county_name, "Superior Counties" = superior_counties,
                                                    "North Coast Counties" = north_coast_counties,
                                                    "San Fancisco Counties" = san_fran_counties,
                                                    "North San Joaquin Valley Counties" = n_san_joaquin_counties,
                                                    "Central Coast Counties" = central_coast_counties,
                                                    "South San Joaquin Valley Counties" = s_san_joaquin_counties,
                                                    "Inland Counties" = inland_counties,
                                                    "Los Angeles County" = la_county,
                                                    "Orange County" = orange_county,
                                                    "San Diego and Imperial County" = san_diego_imperial_counties))
```

-   Factor Example 2 (reordering levels)

```{r}
#| label: wd-4-factor-ex-2
# Challenge 4 Chunk 5
#Graded as growing, no comments given
#REVISIONS: 
# I moved the Y axis to the subtitle to make it so you don't have to read vertical writing, then I made the font smaller than the title, and make the title bold with a gap underneath so it is more distinct what is the title vs subtitle. Then I removed the key header because it said weekly cost but that didn't make sense because Median Income is a variable that is not a weekly value.
# My title was also wrong, it said trends in childcare cost and weekly income. I had thought about doing weekly income but chose to just do median income, and I forgot to change the title. I then learned how to put my y axis in dollars. The variables were also sorted by alphabetical order by default and when I changed the titles around I didn't like the order so I used fct_revel.
#Also, because I removed the legend, I put the graphs side by side and adjusted the aspect ratio, then turned the numbers sideways and make them smaller to not overlap. I think I looks a lot more clean like this.
#I also changed the colors to make it more engaging. 
#I also experimented with a lot of plot themes and I liked the linedraw one a lot, I like how the back boxes look instead of gray. Then I removed every other year so that you could read all the labels horizontally and not have to turn your head. I also changed label dollar to label currency.

plot <- clean_data |>
  rename('Weekly Center Based Care Price' = mcsa, 'Weekly Family Based Care Price' = mfccsa, 'Median Income' = mhi_2018) |>
  pivot_longer(cols = -study_year, names_to = "Variable", values_to = "value") |>
  mutate(Variable = fct_relevel(Variable, 
                                "Weekly Center Based Care Price", 
                                "Weekly Family Based Care Price", 
                                "Median Income")
         )

ggplot(plot, aes(study_year, value, color = Variable)) +
  geom_line() +
  scale_y_continuous(labels = label_currency()) +
  labs(x = "Year", y = "", title = "Trends in Childcare Cost and Median Income", subtitle = "Measurments in US Dollars") +
  facet_wrap(~ Variable, scales = "free_y", nrow = 1) +
  theme_linedraw() +
  scale_x_continuous(breaks = seq(min(plot$study_year),
                                max(plot$study_year),
                                by = 2)) +
  theme(plot.title = element_text(margin = margin(b = 13), face = "bold"), 
        plot.subtitle = element_text(size = 10),
        legend.position = "none",
        aspect.ratio = 0.9,
        axis.text.x = element_text(size = 7)) +
  scale_color_manual(values = c("orange", "coral1", "steelblue2"))
```

-   Character (example must use functions from **stringr**)

```{r}
#| label: wd-4-string
#Lab 4 Question 7
# Your Comments: Nice work pivoting and modifying the age variable!Nice work reordering your legend and your facets!!! I strongly recommend against nested functions, as they are difficult for people to understand what your code is doing. Having two lines is not less efficient and is more readable. Can you relevel the ages BEFORE your facet them? Can you match my colors??? These are coming from a package and you will need to expand the color palette to get all 10 colors.

#REVISION: I removed the nested function of facet_grid(~factor(age_group)) and turned it into simply facet_grid(~age_group), and I defined age group earlier in the pipeline using a fct_relevel, which I used this source to remind myself. https://forcats.tidyverse.org/reference/fct_relevel.html#ref-examples. I learned in challenge 4 how to show every year on the x axis, but I didn't know how to skip years like your graph so I just tilted the labels so you can read them all. Using information from the discord I learned how to import a color palette and expand it, and then assign the colors to my plot with scale_color_manual(). Then I made the legend smaller and I used doge to alternate the year axis labels, I think skipping every other one would look better in this scenario but I thought it was a cool skill I learned so I wanted to show it.

my_colors = colorRampPalette(brewer.pal(7, "Accent"))(10)
graph_maker <- ca_childcare |>
  select(census_region, study_year, starts_with("mc_")) |>
  pivot_longer(cols = c(mc_infant, mc_toddler, mc_preschool),
               names_to = "age_group",
               values_to = "monthly_cost") |>
  mutate(age_group = fct_recode(age_group,
                                "Infant" = "mc_infant",
                                "Toddler" = "mc_toddler",
                                "Preschool" = "mc_preschool"), 
         age_group = fct_relevel(age_group, "Infant", "Toddler", "Preschool")
         )
ggplot(data = graph_maker, 
       mapping = aes(x = study_year, y = monthly_cost,
                     color = fct_reorder2(.f = census_region, .x = study_year, .y = monthly_cost))) +
  geom_point() +
  geom_smooth() +
  theme_bw() +
  theme(aspect.ratio = 1, axis.text.x = element_text(size = 5),
        legend.text = element_text(size = 7),
        legend.title = element_text(size = 10),
        legend.key.size = unit(10, "pt")) +
  scale_color_manual(values = my_colors) +
  labs(
    title = "Weekly Median Price for Center-Based Childcare ($)",
    x = "Study Year", y = "", color = "California Region") +
  facet_grid(~ age_group) +
  scale_x_continuous(breaks = unique(graph_maker$study_year),
                     guide = guide_axis(n.dodge = 2))
```

-   Date (example must use functions from **lubridate**)

```{r}
#| label: wd-4-date
# Lab 5 Chunk3

crime_info <- crime_scene_report |>
  mutate(date = ymd(date), MONTH = case_when(
          month(date) == 1 ~ "January")) |>
  filter(year(date) == 2018, MONTH == "January", day(date) == 15, city == "SQL City", type == "murder") |>
  select(-date, -type, -city) |>
  pull(description)
crime_info
```

**WD-5: I can use mutating joins to combine multiple dataframes.**

-   `left_join()` Example 1

```{r}
#| label: wd-5-left-ex-1
# Lab 5 Chunk 5

gym_member <- get_fit_now_member |>
  left_join(y = get_fit_now_check_in, join_by(id == membership_id)) |>
  filter(str_detect(membership_status, 
           pattern = "gold"), 
         str_detect(id, 
           pattern = "^48Z"))
#two options, Joe Germuska or Jeremy Bowers, need to check license plate now.
plate_check <- almost_everything_data |>
  filter(str_detect(name.x, 
           pattern = "Jeremy Bowers")) |>
  pull(transcript)
plate_check
```

-   `right_join()` Example 1

```{r}
#| label: wd-5-right
# Lab 5 Chunk 5
# moddified left join to right join

gym_member <- get_fit_now_check_in |>
  right_join(y = get_fit_now_member, join_by(membership_id == id)) |>
  filter(str_detect(membership_status, 
           pattern = "gold"), 
         str_detect(id, 
           pattern = "^48Z"))
#two options, Joe Germuska or Jeremy Bowers, need to check license plate now.
plate_check <- almost_everything_data |>
  filter(str_detect(name.x, 
           pattern = "Jeremy Bowers")) |>
  pull(transcript)
plate_check
```

-   `left_join()` **or** `right_join()` Example 2

```{r}
#| label: wd-5-left-right-ex-2
# Challenge 4 Chunk 3

clean_data <- counties |>
  left_join(childcare_costs, join_by(county_fips_code)) |>
  filter(state_name == "California") |>
  group_by(study_year) |>
  summarise(across(
      .cols = c(mcsa, mfccsa, mhi_2018), 
      ~median(.x, na.rm = TRUE))) |>
  select(study_year, mcsa, mfccsa, mhi_2018)
```

-   `inner_join()` Example 1

```{r}
#| label: wd-5-inner-ex-1
# Lab 5 Chunk 5
#modified left join to inner_join

gym_member_who_checked_in <- get_fit_now_check_in |>
  inner_join(y = get_fit_now_member, join_by(membership_id == id)) |>
  filter(str_detect(membership_status, 
           pattern = "gold"), 
         str_detect(id, 
           pattern = "^48Z"))
#two options, Joe Germuska or Jeremy Bowers, need to check license plate now.
plate_check <- almost_everything_data |>
  filter(str_detect(name.x, 
           pattern = "Jeremy Bowers")) |>
  pull(transcript)
plate_check
```

-   `inner_join()` Example 2

```{r}
#| label: wd-5-inner-ex-2
#Lab 4 Question 2
#modified left join to inner_join

ca_childcare <- counties |>
  inner_join(childcare_costs, join_by(county_fips_code)) |>
  filter(state_name == "California")
```

**WD-6: I can use filtering joins to filter rows from a dataframe.**

-   `semi_join()`

```{r}
#| label: wd-6-semi
#Lab 5 Chunk 7
#REVISION: I changed up this code chunk to use semi join and anti join, the semi join is to make sure the suspect has been to the symphony at least three times in December 2017. The anti join is to make sure they are not in the police interview dataset. I know I saved a lot of objects here but that's the only way I could figure out how to do it without a big nested semi join with lots of functions inside of it. 

final_suspects <- almost_everything_data |>
  filter(car_make == "Tesla", 
         car_model == "Model S",
         hair_color == "red",
         gender == "female")

goes_to_symphony <- facebook_event_checkin |>
  mutate(date = ymd(date)) |>
  filter(event_name == "SQL Symphony Concert",
         year(date) == 2017,
         month(date) == 12) |>
  count(person_id) |>
  filter(n >= 3)

final_suspect <- final_suspects |>
  semi_join(goes_to_symphony, by = c("id" = "person_id")) |>
    anti_join(interview, by = c("id" = "person_id")) |>
    pull(name)
final_suspect
```

-   `anti_join()`

```{r}
#| label: wd-6-anti
#Lab 5 Chunk 7
#REVISION: I changed up this code chunk to use semi join and anti join, the semi join is to make sure the suspect has been to the symphony at least three times in December 2017. The anti join is to make sure they are not in the police interview dataset. I know I saved a lot of objects here but that's the only way I could figure out how to do it without a big nested semi join with lots of functions inside of it. 

final_suspects <- almost_everything_data |>
  filter(car_make == "Tesla", 
         car_model == "Model S",
         hair_color == "red",
         gender == "female")

goes_to_symphony <- facebook_event_checkin |>
  mutate(date = ymd(date)) |>
  filter(event_name == "SQL Symphony Concert",
         year(date) == 2017,
         month(date) == 12) |>
  count(person_id) |>
  filter(n >= 3)

final_suspect <- final_suspects |>
  semi_join(goes_to_symphony, by = c("id" = "person_id")) |>
    anti_join(interview, by = c("id" = "person_id")) |>
    pull(name)
final_suspect
```

**WD-7: I can pivot dataframes from long to wide and visa versa**

-   `pivot_longer()`

```{r}
#| label: wd-7-long
# Challenge 4 Chunk 5
#Graded as growing, no comments given
#REVISIONS: 
# I moved the Y axis to the subtitle to make it so you don't have to read vertical writing, then I made the font smaller than the title, and make the title bold with a gap underneath so it is more distinct what is the title vs subtitle. Then I removed the key header because it said weekly cost but that didn't make sense because Median Income is a variable that is not a weekly value.
# My title was also wrong, it said trends in childcare cost and weekly income. I had thought about doing weekly income but chose to just do median income, and I forgot to change the title. I then learned how to put my y axis in dollars. The variables were also sorted by alphabetical order by default and when I changed the titles around I didn't like the order so I used fct_revel.
#Also, because I removed the legend, I put the graphs side by side and adjusted the aspect ratio, then turned the numbers sideways and make them smaller to not overlap. I think I looks a lot more clean like this.
#I also changed the colors to make it more engaging. 
#I also experimented with a lot of plot themes and I liked the linedraw one a lot, I like how the back boxes look instead of gray. Then I removed every other year so that you could read all the labels horizontally and not have to turn your head. I also changed label dollar to label currency.

plot <- clean_data |>
  rename('Weekly Center Based Care Price' = mcsa, 'Weekly Family Based Care Price' = mfccsa, 'Median Income' = mhi_2018) |>
  pivot_longer(cols = -study_year, names_to = "Variable", values_to = "value") |>
  mutate(Variable = fct_relevel(Variable, 
                                "Weekly Center Based Care Price", 
                                "Weekly Family Based Care Price", 
                                "Median Income")
         )

ggplot(plot, aes(study_year, value, color = Variable)) +
  geom_line() +
  scale_y_continuous(labels = label_currency()) +
  labs(x = "Year", y = "", title = "Trends in Childcare Cost and Median Income", subtitle = "Measurments in US Dollars") +
  facet_wrap(~ Variable, scales = "free_y", nrow = 1) +
  theme_linedraw() +
  scale_x_continuous(breaks = seq(min(plot$study_year),
                                max(plot$study_year),
                                by = 2)) +
  theme(plot.title = element_text(margin = margin(b = 13), face = "bold"), 
        plot.subtitle = element_text(size = 10),
        legend.position = "none",
        aspect.ratio = 0.9,
        axis.text.x = element_text(size = 7)) +
  scale_color_manual(values = c("orange", "coral1", "steelblue2"))
```

-   `pivot_wider()`

```{r}
#| label: wd-7-wide
# Lab 4 Question 5
#Your comments: I would recommend using the %in% operator instead of the or!
#Notice that your table still has a grouping variable! Because you grouped by **two** variables, your first group was not dropped!
#Can you give your column names better titles, so the reader knows what "2008" and "2018" represent? What are the values stored in these columns?
#REVISION: I changed the filter from using or to using %in%, I also added a prefix median_income_ to the column names to make them more descriptive. Then ungrouped the data at the end

ca_childcare |>
  filter(study_year %in% c(2008, 2018)) |>
  group_by(census_region, study_year) |>
  summarize(median_income = median(mhi_2018, na.rm = TRUE)) |>
  select(census_region, study_year, median_income) |>
  pivot_wider(names_from = study_year, values_from = median_income, names_prefix = "median_income_") |>
  arrange(desc(median_income_2018)) |>
  ungroup()

```

## Reproducibility

**R-1: I can create professional looking, reproducible analyses using RStudio projects, Quarto documents, and the here package.**

The following assignments satisfy the above criteria:

-   Challenge 4
-   Challenge 7
-   Challenge 2
-   Challenge 3
-   Lab 7

**R-2: I can write well documented and tidy code.**

-   Example of **ggplot2** plotting

```{r}
#| label: r-2-1
# Challenge 4 Chunk 5
#Graded as growing, no comments given
#REVISIONS: 
# I moved the Y axis to the subtitle to make it so you don't have to read vertical writing, then I made the font smaller than the title, and make the title bold with a gap underneath so it is more distinct what is the title vs subtitle. Then I removed the key header because it said weekly cost but that didn't make sense because Median Income is a variable that is not a weekly value.
# My title was also wrong, it said trends in childcare cost and weekly income. I had thought about doing weekly income but chose to just do median income, and I forgot to change the title. I then learned how to put my y axis in dollars. The variables were also sorted by alphabetical order by default and when I changed the titles around I didn't like the order so I used fct_revel.
#Also, because I removed the legend, I put the graphs side by side and adjusted the aspect ratio, then turned the numbers sideways and make them smaller to not overlap. I think I looks a lot more clean like this.
#I also changed the colors to make it more engaging. 
#I also experimented with a lot of plot themes and I liked the linedraw one a lot, I like how the back boxes look instead of gray. Then I removed every other year so that you could read all the labels horizontally and not have to turn your head. I also changed label dollar to label currency.

plot <- clean_data |>
  rename('Weekly Center Based Care Price' = mcsa, 'Weekly Family Based Care Price' = mfccsa, 'Median Income' = mhi_2018) |>
  pivot_longer(cols = -study_year, names_to = "Variable", values_to = "value") |>
  mutate(Variable = fct_relevel(Variable, 
                                "Weekly Center Based Care Price", 
                                "Weekly Family Based Care Price", 
                                "Median Income")
         )

ggplot(plot, aes(study_year, value, color = Variable)) +
  geom_line() +
  scale_y_continuous(labels = label_currency()) +
  labs(x = "Year", y = "", title = "Trends in Childcare Cost and Median Income", subtitle = "Measurments in US Dollars") +
  facet_wrap(~ Variable, scales = "free_y", nrow = 1) +
  theme_linedraw() +
  scale_x_continuous(breaks = seq(min(plot$study_year),
                                max(plot$study_year),
                                by = 2)) +
  theme(plot.title = element_text(margin = margin(b = 13), face = "bold"), 
        plot.subtitle = element_text(size = 10),
        legend.position = "none",
        aspect.ratio = 0.9,
        axis.text.x = element_text(size = 7)) +
  scale_color_manual(values = c("orange", "coral1", "steelblue2"))
```

-   Example of **dplyr** pipeline

```{r}
#| label: r-2-2
# Challenge 4 Chunk 3

clean_data <- counties |>
  left_join(childcare_costs, join_by(county_fips_code)) |>
  filter(state_name == "California") |>
  group_by(study_year) |>
  summarise(across(
      .cols = c(mcsa, mfccsa, mhi_2018), 
      ~median(.x, na.rm = TRUE))) |>
  select(study_year, mcsa, mfccsa, mhi_2018)
```

-   Example of function formatting

```{r}
#| label: r-2-3
#Lab 8 Question 3
#Your Comments: It looks like you are doing the same process to both of your axis labels. Time for a helper function!
#Can you give your plotting function a better name? What does the function do?
#REVISIONS: I renamed the function to make_scatterplot because this is what it does. Then I made a helper function make_title so that just need to call that function within my make_scatterplot function instead of writing the whole str_to_title thing twice.

make_title <- function(str){
  str_to_title(str_replace_all(as_label(enquo(str)), "_", " "))
}

make_scatterplot <- function(df, xvar, yvar){
  xlabel <- make_title({{xvar}})
  ylabel <- make_title({{yvar}})
  label <- rlang::englue("A Scatterplot of {xlabel} and {ylabel}")
  df |>
    ggplot(aes(x = {{xvar}}, y = {{yvar}}, color = {{xvar}})) +
    geom_point() +
    theme(legend.position = "none") +
    labs(x = xlabel, subtitle = ylabel, y = "", title = label)
}
```

**R-3: I can write robust programs that are resistant to changes in inputs.**

-   Example (any context)

```{r}
#| label: r-3-example
#Lab 8 Question 2
#Your comments: Input checks for data frame functions are tricky, but an easy one is to check if the data frame being input is actually a data frame (not a vector or a matrix).
#REVISIONS: I added a data frame check
pivot_table <- function(df, rows, cols){
  if(!is.data.frame(df)) {
    stop("input df is not a dataframe")
  }
  df|>
    count({{rows}}, {{cols}}) |>
    pivot_wider(names_from = {{ cols }},
                values_from = n,
                values_fill = 0) |>
    janitor::adorn_totals(where = c("row", "col"))
}

```

-   Example (function stops)

```{r}
#| label: r-3-function-stops
#Lab 8 Question 1
#Your comments: This code works but doesnâ€™t use the most current code formatting for across()! Could you used named arguments? Could you incorporate the ~ and .x into the rescale_01() function?
#Input checks for data frame functions are tricky, but an easy one is to check if the data frame being input is actually a data frame (not a vector or a matrix).
#REVISIONS: I added named functions for .cols and .fns and I used ~ and .x. Then I added a is.data.frame check where it stops if it isnt a dataframe.

rescale_01 <- function(vec){
  stopifnot(is.numeric(vec))
  if(any(vec < 1, na.rm = TRUE)){
    stop("Input value must be greater than one")}
  r <- range(vec, na.rm = TRUE)
  (vec - r[1])/
    (r[2] - r[1])
}
rescale_column <- function(df, cols){
  if(!is.data.frame(df)) {
    stop("input df is not a dataframe")
  }
  df |>
    mutate(across(
      .cols = {{cols}}, 
      .fns = ~ rescale_01(.x)))
}
```

## Data Visualization & Summarization

**DVS-1: I can create visualizations for a *variety* of variable types (e.g., numeric, character, factor, date)**

-   At least two numeric variables

```{r}
#| label: dvs-1-num
# Lab 4 Question 8
# REVISIONS: I added label currency to both axes

scatterplot <- ca_childcare |>
  select(mc_infant, mhi_2018)
ggplot(data = scatterplot, mapping = aes(x = mhi_2018, y = mc_infant)) +
  geom_point()+
  theme_bw() +
  labs(x = "Median Household Income", y = "Infant Childcare Cost") +
  geom_smooth(method ='lm', formula = y~x) +
  scale_x_continuous(labels = label_currency()) +
  scale_y_continuous(labels = label_currency())
```

-   At least one numeric variable and one categorical variable

```{r}
#| label: dvs-2-num-cat
# Lab 2 Problem 8
#REVISION: I used doge instead of doing the 45 degree tilt

ggplot(data = surveys,
       mapping = aes(x = species, y = weight)) +
  geom_boxplot(outliers = FALSE) +
  geom_jitter(height = 0, width = 0.3, alpha = 0.25, color = "steelblue") +
  labs(x = "Species of Animal", y = "Weight (Grams)", title = "Animal Weight by Species") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2))
```

-   At least two categorical variables

```{r}
#| label: dvs-2-cat
# Challenge 3 Question 2
#Your comments: Incredible work! Nice job matching the colors, the percentage labels, and the legend position!
#Technically, the percent() function has been superseded. Meaning, there are other functions you should use instead. #Specifically, the  label_percent() function has replaced this function.
#REVISION: I used label_percent instead of scales::percent

ggplot(data = teacher_evals_compare,
       mapping = aes(x = sen_level, fill = SET_level)) +
  geom_bar(stat = "count", position = "fill") +
  labs(
    title = "Evaluation of Teachers' Use of Activities",
    x = "Years of Experience", y = "", fill = "Evaluation Rating"
  ) +
  scale_y_continuous(labels = label_percent()) +
  theme_bw() +
  theme(legend.position = "top") +
  scale_fill_manual(values = c("excellent" = "#c77cff", "standard" = "#cd9600"))
```

-   Dates (time series plot)

```{r}
#| label: dvs-2-date
# Challenge 4 Chunk 5
#Graded as growing, no comments given
#REVISIONS: 
# I moved the Y axis to the subtitle to make it so you don't have to read vertical writing, then I made the font smaller than the title, and make the title bold with a gap underneath so it is more distinct what is the title vs subtitle. Then I removed the key header because it said weekly cost but that didn't make sense because Median Income is a variable that is not a weekly value.
# My title was also wrong, it said trends in childcare cost and weekly income. I had thought about doing weekly income but chose to just do median income, and I forgot to change the title. I then learned how to put my y axis in dollars. The variables were also sorted by alphabetical order by default and when I changed the titles around I didn't like the order so I used fct_revel.
#Also, because I removed the legend, I put the graphs side by side and adjusted the aspect ratio, then turned the numbers sideways and make them smaller to not overlap. I think I looks a lot more clean like this.
#I also changed the colors to make it more engaging. 
#I also experimented with a lot of plot themes and I liked the linedraw one a lot, I like how the back boxes look instead of gray. Then I removed every other year so that you could read all the labels horizontally and not have to turn your head. I also changed label dollar to label currency.

plot <- clean_data |>
  rename('Weekly Center Based Care Price' = mcsa, 'Weekly Family Based Care Price' = mfccsa, 'Median Income' = mhi_2018) |>
  pivot_longer(cols = -study_year, names_to = "Variable", values_to = "value") |>
  mutate(Variable = fct_relevel(Variable, 
                                "Weekly Center Based Care Price", 
                                "Weekly Family Based Care Price", 
                                "Median Income")
         )

ggplot(plot, aes(study_year, value, color = Variable)) +
  geom_line() +
  scale_y_continuous(labels = label_currency()) +
  labs(x = "Year", y = "", title = "Trends in Childcare Cost and Median Income", subtitle = "Measurments in US Dollars") +
  facet_wrap(~ Variable, scales = "free_y", nrow = 1) +
  theme_linedraw() +
  scale_x_continuous(breaks = seq(min(plot$study_year),
                                max(plot$study_year),
                                by = 2)) +
  theme(plot.title = element_text(margin = margin(b = 13), face = "bold"), 
        plot.subtitle = element_text(size = 10),
        legend.position = "none",
        aspect.ratio = 0.9,
        axis.text.x = element_text(size = 7)) +
  scale_color_manual(values = c("orange", "coral1", "steelblue2"))
```

**DVS-2: I use plot modifications to make my visualization clear to the reader.**

-   I can modify my plot theme to be more readable

```{r}
#| label: dvs-2-ex-1
# Challenge 4 Chunk 5
#Graded as growing, no comments given
#REVISIONS: 
# I moved the Y axis to the subtitle to make it so you don't have to read vertical writing, then I made the font smaller than the title, and make the title bold with a gap underneath so it is more distinct what is the title vs subtitle. Then I removed the key header because it said weekly cost but that didn't make sense because Median Income is a variable that is not a weekly value.
# My title was also wrong, it said trends in childcare cost and weekly income. I had thought about doing weekly income but chose to just do median income, and I forgot to change the title. I then learned how to put my y axis in dollars. The variables were also sorted by alphabetical order by default and when I changed the titles around I didn't like the order so I used fct_revel.
#Also, because I removed the legend, I put the graphs side by side and adjusted the aspect ratio, then turned the numbers sideways and make them smaller to not overlap. I think I looks a lot more clean like this.
#I also changed the colors to make it more engaging. 
#I also experimented with a lot of plot themes and I liked the linedraw one a lot, I like how the back boxes look instead of gray. Then I removed every other year so that you could read all the labels horizontally and not have to turn your head. I also changed label dollar to label currency.

plot <- clean_data |>
  rename('Weekly Center Based Care Price' = mcsa, 'Weekly Family Based Care Price' = mfccsa, 'Median Income' = mhi_2018) |>
  pivot_longer(cols = -study_year, names_to = "Variable", values_to = "value") |>
  mutate(Variable = fct_relevel(Variable, 
                                "Weekly Center Based Care Price", 
                                "Weekly Family Based Care Price", 
                                "Median Income")
         )

ggplot(plot, aes(study_year, value, color = Variable)) +
  geom_line() +
  scale_y_continuous(labels = label_currency()) +
  labs(x = "Year", y = "", title = "Trends in Childcare Cost and Median Income", subtitle = "Measurments in US Dollars") +
  facet_wrap(~ Variable, scales = "free_y", nrow = 1) +
  theme_linedraw() +
  scale_x_continuous(breaks = seq(min(plot$study_year),
                                max(plot$study_year),
                                by = 2)) +
  theme(plot.title = element_text(margin = margin(b = 13), face = "bold"), 
        plot.subtitle = element_text(size = 10),
        legend.position = "none",
        aspect.ratio = 0.9,
        axis.text.x = element_text(size = 7)) +
  scale_color_manual(values = c("orange", "coral1", "steelblue2"))
```

-   I can modify my colors to be accessible to anyone's eyes

```{r}
#| label: dvs-2-ex-2
# Challenge 4 Chunk 5
#Graded as growing, no comments given
#REVISIONS: 
# I moved the Y axis to the subtitle to make it so you don't have to read vertical writing, then I made the font smaller than the title, and make the title bold with a gap underneath so it is more distinct what is the title vs subtitle. Then I removed the key header because it said weekly cost but that didn't make sense because Median Income is a variable that is not a weekly value.
# My title was also wrong, it said trends in childcare cost and weekly income. I had thought about doing weekly income but chose to just do median income, and I forgot to change the title. I then learned how to put my y axis in dollars. The variables were also sorted by alphabetical order by default and when I changed the titles around I didn't like the order so I used fct_revel.
#Also, because I removed the legend, I put the graphs side by side and adjusted the aspect ratio, then turned the numbers sideways and make them smaller to not overlap. I think I looks a lot more clean like this.
#I also changed the colors to make it more engaging. 
#I also experimented with a lot of plot themes and I liked the linedraw one a lot, I like how the back boxes look instead of gray. Then I removed every other year so that you could read all the labels horizontally and not have to turn your head. I also changed label dollar to label currency.

plot <- clean_data |>
  rename('Weekly Center Based Care Price' = mcsa, 'Weekly Family Based Care Price' = mfccsa, 'Median Income' = mhi_2018) |>
  pivot_longer(cols = -study_year, names_to = "Variable", values_to = "value") |>
  mutate(Variable = fct_relevel(Variable, 
                                "Weekly Center Based Care Price", 
                                "Weekly Family Based Care Price", 
                                "Median Income")
         )

ggplot(plot, aes(study_year, value, color = Variable)) +
  geom_line() +
  scale_y_continuous(labels = label_currency()) +
  labs(x = "Year", y = "", title = "Trends in Childcare Cost and Median Income", subtitle = "Measurments in US Dollars") +
  facet_wrap(~ Variable, scales = "free_y", nrow = 1) +
  theme_linedraw() +
  scale_x_continuous(breaks = seq(min(plot$study_year),
                                max(plot$study_year),
                                by = 2)) +
  theme(plot.title = element_text(margin = margin(b = 13), face = "bold"), 
        plot.subtitle = element_text(size = 10),
        legend.position = "none",
        aspect.ratio = 0.9,
        axis.text.x = element_text(size = 7)) +
  scale_color_manual(values = c("orange", "coral1", "steelblue2"))
```

-   I can modify my plot titles to clearly communicate the data context

```{r}
#| label: dvs-2-ex-3
# Challenge 4 Chunk 5
#Graded as growing, no comments given
#REVISIONS: 
# I moved the Y axis to the subtitle to make it so you don't have to read vertical writing, then I made the font smaller than the title, and make the title bold with a gap underneath so it is more distinct what is the title vs subtitle. Then I removed the key header because it said weekly cost but that didn't make sense because Median Income is a variable that is not a weekly value.
# My title was also wrong, it said trends in childcare cost and weekly income. I had thought about doing weekly income but chose to just do median income, and I forgot to change the title. I then learned how to put my y axis in dollars. The variables were also sorted by alphabetical order by default and when I changed the titles around I didn't like the order so I used fct_revel.
#Also, because I removed the legend, I put the graphs side by side and adjusted the aspect ratio, then turned the numbers sideways and make them smaller to not overlap. I think I looks a lot more clean like this.
#I also experimented with a lot of plot themes and I liked the linedraw one a lot, I like how the back boxes look instead of gray. Then I removed every other year so that you could read all the labels horizontally and not have to turn your head. I also changed label dollar to label currency.
#NEW REVISION: I looked up and found the Okabe-Ito palette which is known for being color blind friendly, and I copied some of the hex codes for three of the colors that look very different even with the color blind filter on.

plot <- clean_data |>
  rename('Weekly Center Based Care Price' = mcsa, 'Weekly Family Based Care Price' = mfccsa, 'Median Income' = mhi_2018) |>
  pivot_longer(cols = -study_year, names_to = "Variable", values_to = "value") |>
  mutate(Variable = fct_relevel(Variable, 
                                "Weekly Center Based Care Price", 
                                "Weekly Family Based Care Price", 
                                "Median Income")
         )

ggplot(plot, aes(study_year, value, color = Variable)) +
  geom_line() +
  scale_y_continuous(labels = label_currency()) +
  labs(x = "Year", y = "", title = "Trends in Childcare Cost and Median Income", subtitle = "Measurments in US Dollars") +
  facet_wrap(~ Variable, scales = "free_y", nrow = 1) +
  theme_linedraw() +
  scale_x_continuous(breaks = seq(min(plot$study_year),
                                max(plot$study_year),
                                by = 2)) +
  theme(plot.title = element_text(margin = margin(b = 13), face = "bold"), 
        plot.subtitle = element_text(size = 10),
        legend.position = "none",
        aspect.ratio = 0.9,
        axis.text.x = element_text(size = 7)) +
  scale_color_manual(values = c("#CC79A7", "#0072B2", "#E69F00"))
```

-   I can modify the text in my plot to be more readable

```{r}
#| label: dvs-2-ex-4
# Challenge 4 Chunk 5
#Graded as growing, no comments given
#REVISIONS: 
# I moved the Y axis to the subtitle to make it so you don't have to read vertical writing, then I made the font smaller than the title, and make the title bold with a gap underneath so it is more distinct what is the title vs subtitle. Then I removed the key header because it said weekly cost but that didn't make sense because Median Income is a variable that is not a weekly value.
# My title was also wrong, it said trends in childcare cost and weekly income. I had thought about doing weekly income but chose to just do median income, and I forgot to change the title. I then learned how to put my y axis in dollars. The variables were also sorted by alphabetical order by default and when I changed the titles around I didn't like the order so I used fct_revel.
#Also, because I removed the legend, I put the graphs side by side and adjusted the aspect ratio, then turned the numbers sideways and make them smaller to not overlap. I think I looks a lot more clean like this.
#I also changed the colors to make it more engaging. 
#I also experimented with a lot of plot themes and I liked the linedraw one a lot, I like how the back boxes look instead of gray. Then I removed every other year so that you could read all the labels horizontally and not have to turn your head. I also changed label dollar to label currency.

plot <- clean_data |>
  rename('Weekly Center Based Care Price' = mcsa, 'Weekly Family Based Care Price' = mfccsa, 'Median Income' = mhi_2018) |>
  pivot_longer(cols = -study_year, names_to = "Variable", values_to = "value") |>
  mutate(Variable = fct_relevel(Variable, 
                                "Weekly Center Based Care Price", 
                                "Weekly Family Based Care Price", 
                                "Median Income")
         )

ggplot(plot, aes(study_year, value, color = Variable)) +
  geom_line() +
  scale_y_continuous(labels = label_currency()) +
  labs(x = "Year", y = "", title = "Trends in Childcare Cost and Median Income", subtitle = "Measurments in US Dollars") +
  facet_wrap(~ Variable, scales = "free_y", nrow = 1) +
  theme_linedraw() +
  scale_x_continuous(breaks = seq(min(plot$study_year),
                                max(plot$study_year),
                                by = 2)) +
  theme(plot.title = element_text(margin = margin(b = 13), face = "bold"), 
        plot.subtitle = element_text(size = 10),
        legend.position = "none",
        aspect.ratio = 0.9,
        axis.text.x = element_text(size = 7)) +
  scale_color_manual(values = c("orange", "coral1", "steelblue2"))
```

-   I can reorder my legend to align with the colors in my plot

```{r}
#| label: dvs-2-ex-5
#Lab 4 Question 7
# Your Comments: Nice work pivoting and modifying the age variable!Nice work reordering your legend and your facets!!! I strongly recommend against nested functions, as they are difficult for people to understand what your code is doing. Having two lines is not less efficient and is more readable. Can you relevel the ages BEFORE your facet them? Can you match my colors??? These are coming from a package and you will need to expand the color palette to get all 10 colors.

#REVISION: I removed the nested function of facet_grid(~factor(age_group)) and turned it into simply facet_grid(~age_group), and I defined age group earlier in the pipeline using a fct_relevel, which I used this source to remind myself. https://forcats.tidyverse.org/reference/fct_relevel.html#ref-examples. I learned in challenge 4 how to show every year on the x axis, but I didn't know how to skip years like your graph so I just tilted the labels so you can read them all. Using information from the discord I learned how to import a color palette and expand it, and then assign the colors to my plot with scale_color_manual(). Then I made the legend smaller and I used doge to alternate the year axis labels, I think skipping every other one would look better in this scenario but I thought it was a cool skill I learned so I wanted to show it.

my_colors = colorRampPalette(brewer.pal(7, "Accent"))(10)
graph_maker <- ca_childcare |>
  select(census_region, study_year, starts_with("mc_")) |>
  pivot_longer(cols = c(mc_infant, mc_toddler, mc_preschool),
               names_to = "age_group",
               values_to = "monthly_cost") |>
  mutate(age_group = fct_recode(age_group,
                                "Infant" = "mc_infant",
                                "Toddler" = "mc_toddler",
                                "Preschool" = "mc_preschool"), 
         age_group = fct_relevel(age_group, "Infant", "Toddler", "Preschool")
         )
ggplot(data = graph_maker, 
       mapping = aes(x = study_year, y = monthly_cost,
                     color = fct_reorder2(.f = census_region, .x = study_year, .y = monthly_cost))) +
  geom_point() +
  geom_smooth() +
  theme_bw() +
  theme(aspect.ratio = 1, axis.text.x = element_text(size = 5),
        legend.text = element_text(size = 7),
        legend.title = element_text(size = 10),
        legend.key.size = unit(10, "pt")) +
  scale_color_manual(values = my_colors) +
  labs(
    title = "Weekly Median Price for Center-Based Childcare ($)",
    x = "Study Year", y = "", color = "California Region") +
  facet_grid(~ age_group) +
  scale_x_continuous(breaks = unique(graph_maker$study_year),
                     guide = guide_axis(n.dodge = 2))
```

**DVS-3: I show creativity in my visualizations**

-   I can use non-standard colors (Example 1)

```{r}
#| label: dvs-3-1-ex-1
#Lab 4 Question 7
# Your Comments: Nice work pivoting and modifying the age variable!Nice work reordering your legend and your facets!!! I strongly recommend against nested functions, as they are difficult for people to understand what your code is doing. Having two lines is not less efficient and is more readable. Can you relevel the ages BEFORE your facet them? Can you match my colors??? These are coming from a package and you will need to expand the color palette to get all 10 colors.

#REVISION: I removed the nested function of facet_grid(~factor(age_group)) and turned it into simply facet_grid(~age_group), and I defined age group earlier in the pipeline using a fct_relevel, which I used this source to remind myself. https://forcats.tidyverse.org/reference/fct_relevel.html#ref-examples. I learned in challenge 4 how to show every year on the x axis, but I didn't know how to skip years like your graph so I just tilted the labels so you can read them all. Using information from the discord I learned how to import a color palette and expand it, and then assign the colors to my plot with scale_color_manual(). Then I made the legend smaller and I used doge to alternate the year axis labels, I think skipping every other one would look better in this scenario but I thought it was a cool skill I learned so I wanted to show it.

my_colors = colorRampPalette(brewer.pal(7, "Accent"))(10)
graph_maker <- ca_childcare |>
  select(census_region, study_year, starts_with("mc_")) |>
  pivot_longer(cols = c(mc_infant, mc_toddler, mc_preschool),
               names_to = "age_group",
               values_to = "monthly_cost") |>
  mutate(age_group = fct_recode(age_group,
                                "Infant" = "mc_infant",
                                "Toddler" = "mc_toddler",
                                "Preschool" = "mc_preschool"), 
         age_group = fct_relevel(age_group, "Infant", "Toddler", "Preschool")
         )
ggplot(data = graph_maker, 
       mapping = aes(x = study_year, y = monthly_cost,
                     color = fct_reorder2(.f = census_region, .x = study_year, .y = monthly_cost))) +
  geom_point() +
  geom_smooth() +
  theme_bw() +
  theme(aspect.ratio = 1, axis.text.x = element_text(size = 5),
        legend.text = element_text(size = 7),
        legend.title = element_text(size = 10),
        legend.key.size = unit(10, "pt")) +
  scale_color_manual(values = my_colors) +
  labs(
    title = "Weekly Median Price for Center-Based Childcare ($)",
    x = "Study Year", y = "", color = "California Region") +
  facet_grid(~ age_group) +
  scale_x_continuous(breaks = unique(graph_maker$study_year),
                     guide = guide_axis(n.dodge = 2))
```

-   I can use non-standard colors (Example 2)

```{r}
#| label: dvs-3-1-ex-2
#Lab 2 Question 4
#Your Comments: When faceting by **one** categorical variable, we need to use facet_wrap()! The facet_grid() function is built for faceting by **two** variables.
#REVISIONS: I changed it from facet_grid to facet_wrap. I forgot that grid is for two quantitative variables, but this only used one so I needed facet_wrap.
my_colors = colorRampPalette(brewer.pal(9, "Set1"))(14)
ggplot(data = surveys, 
    mapping = aes(x = weight, y = hindfoot_length, color = species)) +
    geom_point(alpha = 0.3) +
    facet_wrap(~ species) +
    labs(x = "Animal Weight (Grams)", y = "", 
    title = "Animal Weight and Hindfoot Length by Species",
    subtitle = "Y axis = Hindfoot Length (MM)") +
    scale_color_manual(values = my_colors)
```

-   I can use annotations (e.g., `geom_text()`)

```{r}
#| label: dvs-3-2
#Lab 10 Question 3
#Your Comments: What is the context of these simulations? What does a â€œcorrectâ€ assignment mean? What was assigned?
#How many total babies could have been assigned? 4? 5? 6? That information should be included in you plot title!
#How many simultations were run? That information should be included in your title!
#REVISIONS: I changed the title and subtitle to be more descriptive, and then used geom_text to add the proportions over each bar.

results |>
  enframe() |>
  count(value) |>
  mutate(prop = n / sum(n)) |>
  select(value, prop) |>
  ggplot(aes(x = value, y = prop)) +
  geom_col(fill = "green4") +
  scale_y_continuous(labels = label_percent()) +
  scale_x_continuous(breaks = 0:4, limits = c(-1,5)) +
  theme_linedraw() +
  labs(title = "Number of Baby and Mother Correct Matches out of 4 Pairs (10000 Simulations)", y = "", subtitle = "Proportion of 10000 simulations") +
  geom_text(aes(label = percent(prop), y = prop + 0.01))
```

-   I can choose creative geometries (e.g., `geom_segment()`, `geom_ribbon)()`)

```{r}
#| label: dvs-3-3
#Challenge 7 Question 5
#REVISION: I added the geom_segment making a line from the first year of the study to the last, in this graph it doesn't show all that much but the goal would be to show an overall change in fish health from the first year to last year of the study.

graph_data <- modified_fish |>
  mutate(condition_index = conditionidx(weight, length)) |>
  group_by(year, species) |>
  summarize(average_condition_index = mean(condition_index, na.rm = TRUE), .groups = "drop")

connecting_line_data <- graph_data |>
   group_by(species) |>
      arrange(year) |>
      summarize(x1 = first(year),
                x2 = last(year),
                y1 = first(average_condition_index),
                y2 = last(average_condition_index), 
                .groups = "drop")

  ggplot(data = graph_data, aes(x = year, y = average_condition_index, color = species)) +
     geom_segment(data = connecting_line_data, aes(x = x1, y = y1,
        xend = x2, yend = y2,
        color = species),
    linewidth = 0.55,
    linetype = "dashed") +
  geom_line() +
  geom_point() +
  geom_hline(aes(yintercept = 1)) +
  theme_linedraw() +
  facet_wrap(~species, nrow = 2) +
  theme(legend.position = "none") +
  labs(x = "Year", y = "", subtitle = "Condition Index", title = "Fish Health by Species")
```

**DVS-4: I can calculate numerical summaries of variables.**

-   Example using `summarize()`

```{r}
#| label: dvs-4-summarize
# Lab 10 Question 1
#Your Comments: What tools have we learned in this class to select elements and summarize statistics?
#REVISION: I changed it to add the summarize function and pipe in the dataframe before so I dont need to use the dollar sign to grab columns.

randomBabies <- function(n_babies){
  babies_data <- tibble(baby = 1:n_babies,
                      mother = sample(1:n_babies, 
                                      size = n_babies, 
                                      replace = FALSE)
                      )
  babies_data |>
    summarize(matches = sum(baby == mother)) |>
    pull(matches)
}
```

-   Example using `across()`

```{r}
#| label: dvs-4-across
# Challenge 4 Chunk 3

clean_data <- counties |>
  left_join(childcare_costs, join_by(county_fips_code)) |>
  filter(state_name == "California") |>
  group_by(study_year) |>
  summarise(across(
      .cols = c(mcsa, mfccsa, mhi_2018), 
      ~median(.x, na.rm = TRUE))) |>
  select(study_year, mcsa, mfccsa, mhi_2018)
```

**DVS-5: I can find summaries of variables across multiple groups.**

-   Example 1

```{r}
#| label: dvs-5-1
# Challenge 4 Chunk 3

clean_data <- counties |>
  left_join(childcare_costs, join_by(county_fips_code)) |>
  filter(state_name == "California") |>
  group_by(study_year) |>
  summarise(across(
      .cols = c(mcsa, mfccsa, mhi_2018), 
      ~median(.x, na.rm = TRUE))) |>
  select(study_year, mcsa, mfccsa, mhi_2018)
```

-   Example 2

```{r}
#| label: dvs-5-2
# Lab 4 Question 5
# Your Comments: I would recommend using the %in% operator instead of the or! Notice that your table still has a grouping variable! Because you grouped by **two** variables, your first group was not dropped! Can you give your column names better titles, so the reader knows what "2008" and "2018" represent? What are the values stored in these columns?
#REVISION: I changed the filter from using or to using %in%, I also added a prefix median_income_ to the column names to make them more descriptive, I then ungrouped the data at the end.

ca_childcare |>
  filter(study_year %in% c(2008, 2018)) |>
  group_by(census_region, study_year) |>
  summarize(median_income = median(mhi_2018, na.rm = TRUE)) |>
  select(census_region, study_year, median_income) |>
  pivot_wider(names_from = study_year, values_from = median_income, names_prefix = "median_income_") |>
  arrange(desc(median_income_2018)) |>
  ungroup()
```

**DVS-6: I can create tables which make my summaries clear to the reader.**

-   I can modify my column names to clearly communicate the data context

```{r}
#| label: dvs-6-ex-1
# Lab 4 Question 5
# Your Comments: I would recommend using the %in% operator instead of the or! Notice that your table still has a grouping variable! Because you grouped by **two** variables, your first group was not dropped! Can you give your column names better titles, so the reader knows what "2008" and "2018" represent? What are the values stored in these columns?
#REVISION: I changed the filter from using or to using %in%, I also added a prefix median_income_ to the column names to make them more descriptive, I then ungrouped the data at the end.

ca_childcare |>
  filter(study_year %in% c(2008, 2018)) |>
  group_by(census_region, study_year) |>
  summarize(median_income = median(mhi_2018, na.rm = TRUE)) |>
  select(census_region, study_year, median_income) |>
  pivot_wider(names_from = study_year, values_from = median_income, names_prefix = "median_income_") |>
  arrange(desc(median_income_2018)) |>
  ungroup()
```

-   I can modify the text in my table to be more readable (e.g., bold face for column headers)

```{r}
#| label: dvs-6-ex-2
# Challenge 4 Chunk 4
#Graded as growing, no comments given
#REVISIONS:
# I used as.data.frame() to remove the data types from the final table, and it looks much better after that. Then I adjusted the width so that you can scroll right to see the entire table instead it being stacked on top of each other.I also added some creativity with bold red column titles.

my_colors = colorRampPalette(brewer.pal(9, "Set1"))(1)
options(width = 200)
clean_data |>
  rename('Center Based Care Price' = mcsa,
         'Family Based Care Price' = mfccsa,
         'Median Income' = mhi_2018) |>
  pivot_longer(cols = c('Center Based Care Price', 'Family Based Care Price', 'Median Income'),
               names_to = "Variable", 
               values_to = "value") |>
  pivot_wider(names_from = study_year, values_from = value) |>
  gt() |>
  tab_options(column_labels.font.weight = "bold") |>
  tab_style(style = cell_text(color = my_colors),
    locations = cells_column_labels(everything()))
```

-   I can arrange my table to have an intuitive ordering

```{r}
#| label: dvs-6-ex-3
# Lab 4 Question 5
# Your Comments: I would recommend using the %in% operator instead of the or! Notice that your table still has a grouping variable! Because you grouped by **two** variables, your first group was not dropped! Can you give your column names better titles, so the reader knows what "2008" and "2018" represent? What are the values stored in these columns?
#REVISION: I changed the filter from using or to using %in%, I also added a prefix median_income_ to the column names to make them more descriptive, I then ungrouped the data at the end.

ca_childcare |>
  filter(study_year %in% c(2008, 2018)) |>
  group_by(census_region, study_year) |>
  summarize(median_income = median(mhi_2018, na.rm = TRUE)) |>
  select(census_region, study_year, median_income) |>
  pivot_wider(names_from = study_year, values_from = median_income, names_prefix = "median_income_") |>
  arrange(desc(median_income_2018)) |>
  ungroup()
```

**DVS-7: I show creativity in my tables.**

-   I can use non-default colors

```{r}
#| label: dvs-7-ex-1
# Challenge 4 Chunk 4
#Graded as growing, no comments given
#REVISIONS:
# I used as.data.frame() to remove the data types from the final table, and it looks much better after that. Then I adjusted the width so that you can scroll right to see the entire table instead it being stacked on top of each other.I also added some creativity with bold red column titles.

my_colors = colorRampPalette(brewer.pal(9, "Set1"))(1)
options(width = 200)
clean_data |>
  rename('Center Based Care Price' = mcsa,
         'Family Based Care Price' = mfccsa,
         'Median Income' = mhi_2018) |>
  pivot_longer(cols = c('Center Based Care Price', 'Family Based Care Price', 'Median Income'),
               names_to = "Variable", 
               values_to = "value") |>
  pivot_wider(names_from = study_year, values_from = value) |>
  gt() |>
  tab_options(column_labels.font.weight = "bold") |>
  tab_style(style = cell_text(color = my_colors),
    locations = cells_column_labels(everything()))
```

-   I can modify the layout of my table to be more readable (e.g., `pivot_longer()` or `pivot_wider()`)

```{r}
#| label: dvs-7-ex-2
# Challenge 4 Chunk 4
#Graded as growing, no comments given
#REVISIONS:
# I used as.data.frame() to remove the data types from the final table, and it looks much better after that. Then I adjusted the width so that you can scroll right to see the entire table instead it being stacked on top of each other.I also added some creativity with bold red column titles.

my_colors = colorRampPalette(brewer.pal(9, "Set1"))(1)
options(width = 200)
clean_data |>
  rename('Center Based Care Price' = mcsa,
         'Family Based Care Price' = mfccsa,
         'Median Income' = mhi_2018) |>
  pivot_longer(cols = c('Center Based Care Price', 'Family Based Care Price', 'Median Income'),
               names_to = "Variable", 
               values_to = "value") |>
  pivot_wider(names_from = study_year, values_from = value) |>
  gt() |>
  tab_options(column_labels.font.weight = "bold") |>
  tab_style(style = cell_text(color = my_colors),
    locations = cells_column_labels(everything()))
```

## Program Efficiency

**PE-1: I can write concise code which does not repeat itself.**

-   using a single function call with multiple inputs (rather than multiple function calls)

```{r}
#| label: pe-1-one-call
# Challenge 4 Chunk 3

clean_data <- counties |>
  left_join(childcare_costs, join_by(county_fips_code)) |>
  filter(state_name == "California") |>
  group_by(study_year) |>
  summarise(across(
      .cols = c(mcsa, mfccsa, mhi_2018), 
      ~median(.x, na.rm = TRUE))) |>
  select(study_year, mcsa, mfccsa, mhi_2018)
```

-   using `across()`

```{r}
#| label: pe-1-across
# Challenge 4 Chunk 3

clean_data <- counties |>
  left_join(childcare_costs, join_by(county_fips_code)) |>
  filter(state_name == "California") |>
  group_by(study_year) |>
  summarise(across(
      .cols = c(mcsa, mfccsa, mhi_2018), 
      ~median(.x, na.rm = TRUE))) |>
  select(study_year, mcsa, mfccsa, mhi_2018)
```

-   using functions from the `map()` family

```{r}
#| label: pe-1-map-1
#Lab 9 Question 7

fish |>
  map_int(.f = ~ sum(is.na(.x))) |>
  enframe(name = "Variable",
          value = "Missing Values") |>
  kable() |>
  kable_styling(full_width = FALSE,
                bootstrap_options = "striped")
```

**PE-2: I can write functions to reduce repetition in my code.**

-   Example 1: Function that operates on vectors

```{r}
#| label: pe-2-1
#Lab 8 Question 3
#Your comments: It looks like you are doing the same process to both of your axis labels. Time for a helper function!
#Can you give your plotting function a better name? What does the function do?
#REVISIONS: I renamed the function to make_scatterplot because this is what it does. Then I made a helper function make_title so that just need to call that function within my make_scatterplot function instead of writing the whole str_to_title thing twice.

make_title <- function(str){
  str_to_title(str_replace_all(as_label(enquo(str)), "_", " "))
}

make_scatterplot <- function(df, xvar, yvar){
  xlabel <- make_title({{xvar}})
  ylabel <- make_title({{yvar}})
  label <- rlang::englue("A Scatterplot of {xlabel} and {ylabel}")
  df |>
    ggplot(aes(x = {{xvar}}, y = {{yvar}}, color = {{xvar}})) +
    geom_point() +
    theme(legend.position = "none") +
    labs(x = xlabel, subtitle = ylabel, y = "", title = label)
}
```

-   Example 2: Function that operates on data frames

```{r}
#| label: pe-2-2
# Lab 8 Question 2
#Your Comments: Input checks for data frame functions are tricky, but an easy one is to check if the data frame being input is actually a data frame (not a vector or a matrix).
#REVISIONS: I added a data frame check

pivot_table <- function(df, rows, cols){
  if(!is.data.frame(df)) {
    stop("input df is not a dataframe")
  }
  df|>
    count({{rows}}, {{cols}}) |>
    pivot_wider(names_from = {{ cols }},
                values_from = n,
                values_fill = 0) |>
    janitor::adorn_totals(where = c("row", "col"))
}
```

-   Example 3: Function that operates on vectors *or* data frames

```{r}
#| label: pe-2-3
#Lab 8 Question 1
#Your Comments: Input checks for data frame functions are tricky, but an easy one is to check if the data frame being input is actually a data frame (not a vector or a matrix).
#REVISIONS: I added named functions for .cols and .fns and I used ~ and .x. Then I added a is.data.frame check where it stops if it isnt a dataframe.

rescale_01 <- function(vec){
  stopifnot(is.numeric(vec))
  if(any(vec < 1, na.rm = TRUE)){
    stop("Input value must be greater than one")}
  r <- range(vec, na.rm = TRUE)
  (vec - r[1])/
    (r[2] - r[1])
}
rescale_column <- function(df, cols){
  if(!is.data.frame(df)) {
    stop("input df is not a dataframe")
  }
  df |>
    mutate(across(
      .cols = {{cols}}, 
      .fns = ~ rescale_01(.x)))
}
```

**PE-3:I can use iteration to reduce repetition in my code.**

-   using `across()`

```{r}
#| label: pe-3-across
# Lab 7 Question 1

missing_values <- fish |>
  summarize(
    across(trip:species, ~sum(is.na(.)))
  )
missing_values
```

-   using a `map()` function with **one** input (e.g., `map()`, `map_chr()`, `map_dbl()`, etc.)

```{r}
#| label: pe-3-map-1
#Lab 9 Question 7

fish |>
  map_int(.f = ~ sum(is.na(.x))) |>
  enframe(name = "Variable",
          value = "Missing Values") |>
  kable() |>
  kable_styling(full_width = FALSE,
                bootstrap_options = "striped")
```

-   using a `map()` function with **one** input (e.g., `map()`, `map_chr()`, `map_dbl()`, etc.)

```{r}
#| label: pe-3-map-2
#Lab 9 Question 2

surveys |>
  map_chr(.f = ~ class(.x)) |>
  enframe(name = "Variable",
          value = "Data Type") |>
  kable()
```

**PE-4: I can use modern tools when carrying out my analysis.**

-   I can use functions which are not superseded or deprecated

```{r}
#| label: pe-4-1
# Challenge 3 Question 2
#Your Comments: Technically, the percent() function has been superseded. Meaning, there are other functions you should use instead. Specifically, the  label_percent() function has replaced this function.
# REVISIONS: You told me the percent function I used was superseded so I used label_percent() instead.

ggplot(data = teacher_evals_compare,
       mapping = aes(x = sen_level, fill = SET_level)) +
  geom_bar(stat = "count", position = "fill") +
  labs(
    title = "Evaluation of Teachers' Use of Activities",
    x = "Years of Experience", y = "", fill = "Evaluation Rating"
  ) +
  scale_y_continuous(labels = label_percent()) +
  theme_bw() +
  theme(legend.position = "top") +
  scale_fill_manual(values = c("excellent" = "#c77cff", "standard" = "#cd9600"))
```

-   I can connect a data wrangling pipeline into a `ggplot()`

```{r}
#| label: pe-4-2
#Lab 7 Question 3
#Your comments: I would still recommend recoding the trip variable before plotting, so the facets have more informative names like "Trip 1" instead of "1". You have a variety of tools youâ€™ve learned that would be a good fit for this task -- if_else() or fct_recode() would be great places to start!
#REVISION: I used factor recode to change the titles from 1 and 2 to trip 1 and trip 2. I had to use as.factor becuase it was saying the input cannot be a double. I also added more detail to the title so that it provides additional information for the viewer. Finally, I turned year into a factor and made the text smaller so the x axis would show every date.

fish |>
  select(weight, year, section, trip) |>
  group_by(year, section, trip) |>
  summarize(number_of_missing_values = sum(is.na(weight)), .groups = "drop") |>
  mutate(trip = fct_recode(as.factor(trip), "Trip 1" = "1", "Trip 2" = "2"),
         year = as.factor(year)) |>
  ggplot(aes(x = year, y = number_of_missing_values, fill = section)) +
  geom_col(position = "dodge") +
  facet_wrap(~trip) +
  labs(title = "Missing Trout Weight Data From Mark Recapture Study (Blackfoot River, Montana)", x = "Year", y = "", subtitle = "Number of Missing Values") +
  theme(axis.text.x = element_text(size = 7)) 
```

## Data Simulation & Statisical Models

**DSSM-1: I can simulate data from a *variety* of probability models.**

-   Example 1

```{r}
#| label: dsm-1-1
#Lab 10 Question 8

mycifun <- function(beta0, beta1, n){
  intercept = beta0
  slope = beta1
  x <- runif(n, min = 0, max = 1)
  ep <- rnorm(n, mean = 0, sd = 1)
  y = intercept + x*slope + ep
  observed_data <- tibble(x, y)
  simmed_lm <- lm(y ~ x, 
                 data = observed_data)
  broom::tidy(simmed_lm, 
            conf.int = TRUE, 
            conf.level = 0.95) |>
  filter(term == "x") |> 
  select(estimate, conf.low, conf.high) |>
  mutate(cover = ifelse(beta1 >= conf.low & beta1 <= conf.high, 1, 0))
}
```

-   Example 2

```{r}
#| label: dsm-1-2
#Lab 10 Question 1
#Your comments: What tools have we learned in this class to select elements and summarize statistics?
#REVISION: I changed it to a summarize piping in the dataframe before so I don't need to use the dollar sign to grab columns.

randomBabies <- function(n_babies){
  babies_data <- tibble(baby = 1:n_babies,
                      mother = sample(1:n_babies, 
                                      size = n_babies, 
                                      replace = FALSE)
                      )
  babies_data |>
    summarize(matches = sum(baby == mother)) |>
    pull(matches)
}
```

**DSSM-2: I can conduct common statistical analyses in R.**

-   Example 1

```{r}
#| label: dsm-2-1
# Lab 4 Question 9

reg_mod1 <- lm(formula = mc_infant ~ mhi_2018, data = scatterplot)
summary(reg_mod1)
```

-   Example 2

```{r}
#| label: dsm-2-2
#Challenge 3 Question 3
#Your Comments: This works, but did you need to make a contingency table? Could you have input these vectors directly into the chisq.test() function?
#REVISION: I took away the pointless contingency table

chisq.test(teacher_evals_compare$SET_level,
                 teacher_evals_compare$sen_level)
```

-   Example 3

```{r}
#| label: dsm-2-3
# Lab 2 Question 17

species_mod <- aov(weight ~ species, data = surveys)

summary(species_mod)
```

## Revising My Thinking

<!-- How did you revise your thinking throughout the course? How did you revise your thinking on the code examples you have provided in your portfolio? -->

I think my biggest strength in this class was revising. I made sure to revise my work every single week even if there were only a couple corrections, and I would even make the changes on questions that got a successful grade. One assignment that stands out to me is Challenge 4, I didn't have much time to work on it so I did my best with the time I had. Then, after I got my revisions, which didn't have any specific feedback it just said Satisfactory, and Progressing. I went back to this assignment and spent a lot of time working on the readability, titles, axes ticks, legend, colors, and themes to make it something I am very proud of and I think is a lot more interesting to look at. I learn so much through the revision process and I think I have demonstrated my commitment to learning in this class by my effort with revisions. Towards the end of the quarter when revisions weren't mandatory, I continued to do all of them and I would even do multiple rounds of revisions until I got satisfactory marks on each category.<!-- For the revisions included in your Portfolio, to help me understand the nature of your revisions, please denote somehow the feedback I provided you (e.g., boldface, italics, colored text) before your revisions. -->

## Extending My Thinking

<!-- How did you extended your thinking throughout the course? How did you extend your thinking on the code examples you have provided in your portfolio? -->

When it comes to the challenge assignments, in order to go above and beyond, I often needed to learn new things that we haven't done in class. But I wouldn't let that stop me from making my output look exactly how I want it. One example is once again the Challenge 4 assignment. Where to get more creative with the table I learned how to use functions like options(width = ) to make it so you can scroll to see the whole graph instead of it being stacked. And I also learned how to use gt() to change the colors and bold the column names. I did a lot of learning outside of what was covered in class, and I think I have gotten good at citing all the sources that my learning is coming from. For this portfolio I added a geom_segment to one of my graphs to draw a line from the first year of data to the last, showing the overall difference from the beginning to end of the study, I often do this myself when I look at tables, and I wanted to learn how to do it. It tool a lot of time and trial and error but I ended up happy with the result and the new skill I have.

## Peer Support & Collaboration

<!-- Include an image or a description of feedback you gave that you are proud of (either in a peer review or in Discord). -->

Peer review for Lab 5:

Hi Scarlet,

I really liked how throughout your assignment you had little pieces that make it easy for the reader to follow along. I like the way you would either printed out the end result of your findings in each code chunk or put comments in your cod chunks and then having them output. This made it super easy to follow along and see the progress being made throughout the search. One thing I'm not sure about is when you were doing your inner joins, you saved joint_data and joint_data2, and gym_person, and in joint_data2 you called back to the first one. Maybe this was the only way to do it but there might have also been a more efficient way of doing it all in one pipeline. You do this later with hire_join as well. That's the only thing that I think could maybe have done more efficiently great job.

<!-- Include a description of how you grew as a collaborator through the weekly pair programming activities.   -->

I think I improved a lot through the weekly pair programming activities. Because I put in a lot of effort with the check ins, I always have a sense of confidence going into the pair activities which I didn't have at the beginning. I am now able to share my ideas without being worried if I made a mistake. And I think I have been a great parter as well, welcoming all ideas, and helping work through the problems together. The last pair activity we did was the one where I felt like I was the best collaborator and we both built of each others ideas. I have also gotten better and better at following the pair activity roles of being the typer and the talker. It is hard to vocalize the code you are thinking of and I think I have gotten a lot better.
